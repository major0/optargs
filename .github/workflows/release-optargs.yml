name: Release

on:
  create:
  push:
    branches:
      - 'v[0-9]+.[0-9]+'
    tags:
      - 'v[0-9]+.[0-9]+.[0-9]+*'
    paths-ignore:
      - 'goargs/**'
      - 'pflags/**'
      - '.github/**'

permissions:
  contents: write

jobs:
  release:
    name: Semantic Version Release
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run Semantic Versioning
        id: semver
        uses: major0/semver-release-action@v1
        with:
          release-prefix: 'v'
          tag-prefix: 'v'

      - name: Summary
        if: steps.semver.outputs.tag != ''
        run: |
          echo "### Release Summary" >> "$GITHUB_STEP_SUMMARY"
          echo "- **Tag**: ${{ steps.semver.outputs.tag }}" >> "$GITHUB_STEP_SUMMARY"
          echo "- **Type**: ${{ steps.semver.outputs.tag-type }}" >> "$GITHUB_STEP_SUMMARY"
